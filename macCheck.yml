---
- name: Recolectar información del sistema Mac
  hosts: localhost
  connection: local
  gather_facts: no

  tasks:
    - name: Obtener el nombre del host
      command: hostname
      register: hostname_info
      changed_when: false

    - name: Mostrar nombre del host
      debug:
        msg: "Nombre del host: {{ hostname_info.stdout }}"

    - name: Obtener versión del sistema operativo
      command: sw_vers -productVersion
      register: macos_version
      changed_when: false

    - name: Mostrar versión del sistema operativo
      debug:
        msg: "Versión de macOS: {{ macos_version.stdout }}"

    - name: Obtener arquitectura del sistema
      command: uname -m
      register: architecture
      changed_when: false

    - name: Mostrar arquitectura
      debug:
        msg: "Arquitectura: {{ architecture.stdout }}"

    - name: Obtener memoria total
      command: sysctl -n hw.memsize
      register: memory_bytes
      changed_when: false

    - name: Calcular memoria en GB
      set_fact:
        memory_gb: "{{ (memory_bytes.stdout | int / (1024**3)) | round(2) }}"

    - name: Mostrar memoria total
      debug:
        msg: "Memoria total: {{ memory_gb }} GB"

    - name: Obtener número de CPU físicas
      command: sysctl -n hw.physicalcpu
      register: cpu_physical
      changed_when: false

    - name: Obtener número de CPU lógicas
      command: sysctl -n hw.logicalcpu
      register: cpu_logical
      changed_when: false

    - name: Mostrar información de CPU
      debug:
        msg: "CPUs físicas: {{ cpu_physical.stdout }}, CPUs lógicas: {{ cpu_logical.stdout }}"

    - name: Obtener espacio libre en disco
      command: df -h /
      register: disk_usage
      changed_when: false

    - name: Mostrar espacio libre en disco
      debug:
        msg: "Información de uso de disco: {{ disk_usage.stdout_lines }}"
